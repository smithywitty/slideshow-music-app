{"ast":null,"code":"import _objectSpread from\"C:/Users/Smith/Documents/slideshow-music-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from'react';import{Play,Pause,Upload,Volume2,Plus,Download,Trash2,Clock,FileText,Maximize2,Minimize2,ChevronLeft,ChevronRight}from'lucide-react';import'./App.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const AdvancedSlideshow=()=>{var _images,_slides$currentSlide,_slides$currentSlide2;const[audioFile,setAudioFile]=useState(null);const[images,setImages]=useState([]);const[currentSlide,setCurrentSlide]=useState(0);const[isPlaying,setIsPlaying]=useState(false);const[duration,setDuration]=useState(0);const[currentTime,setCurrentTime]=useState(0);const[volume,setVolume]=useState(0.7);const[isFullscreen,setIsFullscreen]=useState(false);const[controlsVisible,setControlsVisible]=useState(true);const hideTimeoutRef=useRef(null);// Advanced timing system\nconst[slides,setSlides]=useState([]);const[srtFile,setSrtFile]=useState(null);const[timingMode,setTimingMode]=useState('manual');// 'manual' or 'srt'\nconst audioRef=useRef(null);const fileInputRef=useRef(null);const imageInputRef=useRef(null);const srtInputRef=useRef(null);const slideshowRef=useRef(null);// Auto-hide controls handler\nconst handleMouseMove=()=>{setControlsVisible(true);if(hideTimeoutRef.current){clearTimeout(hideTimeoutRef.current);}hideTimeoutRef.current=setTimeout(()=>{setControlsVisible(false);},2000);};const handleMouseLeave=()=>{setControlsVisible(false);if(hideTimeoutRef.current){clearTimeout(hideTimeoutRef.current);}};// Cleanup timeout on unmount\nuseEffect(()=>{return()=>{if(hideTimeoutRef.current){clearTimeout(hideTimeoutRef.current);}};},[]);// Reset controls visibility when exiting fullscreen\nuseEffect(()=>{if(!isFullscreen){setControlsVisible(true);if(hideTimeoutRef.current){clearTimeout(hideTimeoutRef.current);}}},[isFullscreen]);// Fullscreen handlers\nconst toggleFullscreen=async()=>{if(!document.fullscreenElement){try{await slideshowRef.current.requestFullscreen();setIsFullscreen(true);}catch(err){console.error('Error attempting to enable fullscreen:',err);}}else{try{await document.exitFullscreen();setIsFullscreen(false);}catch(err){console.error('Error attempting to exit fullscreen:',err);}}};// Handle fullscreen change events\nuseEffect(()=>{const handleFullscreenChange=()=>{setIsFullscreen(!!document.fullscreenElement);};document.addEventListener('fullscreenchange',handleFullscreenChange);return()=>{document.removeEventListener('fullscreenchange',handleFullscreenChange);};},[]);// Handle ESC key\nuseEffect(()=>{const handleEscKey=event=>{if(event.key==='Escape'&&isFullscreen){document.exitFullscreen();}};document.addEventListener('keydown',handleEscKey);return()=>{document.removeEventListener('keydown',handleEscKey);};},[isFullscreen]);// Navigation handlers\nconst goToNextSlide=()=>{if(currentSlide<slides.length-1){setCurrentSlide(currentSlide+1);}};const goToPreviousSlide=()=>{if(currentSlide>0){setCurrentSlide(currentSlide-1);}};// Update slide berdasarkan timing\nuseEffect(()=>{if(slides.length>0&&currentTime>0){let activeSlide=0;for(let i=slides.length-1;i>=0;i--){if(currentTime>=slides[i].startTime){activeSlide=i;break;}}if(activeSlide!==currentSlide){setCurrentSlide(activeSlide);}}},[currentTime,slides,currentSlide]);// Convert time string to seconds\nconst timeToSeconds=timeStr=>{// Handle SRT format: HH:MM:SS,mmm\nconst srtMatch=timeStr.match(/^(\\d{2}):(\\d{2}):(\\d{2}),(\\d{3})$/);if(srtMatch){const[,hours,minutes,seconds,milliseconds]=srtMatch;return parseInt(hours)*3600+parseInt(minutes)*60+parseInt(seconds)+parseInt(milliseconds)/1000;}// Handle MM:SS format\nconst parts=timeStr.split(':');if(parts.length===2){const minutes=parseInt(parts[0])||0;const seconds=parseFloat(parts[1])||0;return minutes*60+seconds;}return 0;};// Convert seconds to time string\nconst secondsToTime=seconds=>{if(isNaN(seconds))return'00:00:00,000';const hours=Math.floor(seconds/3600);const minutes=Math.floor(seconds%3600/60);const secs=Math.floor(seconds%60);const ms=Math.floor(seconds%1*1000);return\"\".concat(hours.toString().padStart(2,'0'),\":\").concat(minutes.toString().padStart(2,'0'),\":\").concat(secs.toString().padStart(2,'0'),\",\").concat(ms.toString().padStart(3,'0'));};// Parse SRT file\nconst parseSRT=srtText=>{const blocks=srtText.trim().split('\\n\\n');const parsedSlides=[];blocks.forEach((block,index)=>{const lines=block.split('\\n');if(lines.length>=3){const timeLine=lines[1];const textLines=lines.slice(2);// Parse time format: 00:00:10,500 --> 00:00:13,240\nconst timeMatch=timeLine.match(/^(\\d{2}):(\\d{2}):(\\d{2}),(\\d{3})\\s*-->\\s*(\\d{2}):(\\d{2}):(\\d{2}),(\\d{3})$/);if(timeMatch){const[,startH,startM,startS,startMs,endH,endM,endS,endMs]=timeMatch;const startTime=parseInt(startH)*3600+parseInt(startM)*60+parseInt(startS)+parseInt(startMs)/1000;const endTime=parseInt(endH)*3600+parseInt(endM)*60+parseInt(endS)+parseInt(endMs)/1000;// Combine all text lines\nconst text=textLines.join('\\n').trim();parsedSlides.push({id:Date.now()+index,text:text,startTime:startTime,endTime:endTime,imageIndex:Math.min(index,images.length-1)});}}});return parsedSlides;};// Handle SRT file upload\nconst handleSRTUpload=event=>{const file=event.target.files[0];if(file&&file.name.endsWith('.srt')){const reader=new FileReader();reader.onload=e=>{const srtText=e.target.result;console.log('SRT content:',srtText);const parsedSlides=parseSRT(srtText);console.log('Parsed slides:',parsedSlides);if(parsedSlides.length>0){setSlides(parsedSlides);setSrtFile(file.name);setTimingMode('srt');setCurrentSlide(0);}else{alert('Could not parse SRT file. Please check the format.');}};reader.readAsText(file);}else{alert('Please select a valid .srt file');}event.target.value='';};// Handle audio file upload\nconst handleAudioUpload=event=>{const file=event.target.files[0];if(file&&file.type.startsWith('audio/')){const url=URL.createObjectURL(file);setAudioFile(url);setCurrentTime(0);setCurrentSlide(0);setIsPlaying(false);}event.target.value='';};// Handle image files upload\nconst handleImagesUpload=event=>{const files=Array.from(event.target.files);if(files.length===0)return;const imageUrls=[];files.forEach(file=>{if(file.type.startsWith('image/')){const url=URL.createObjectURL(file);imageUrls.push({url,name:file.name});}});setImages(imageUrls);setCurrentSlide(0);// If no slides yet, create default slides\nif(slides.length===0&&timingMode==='manual'){createDefaultSlides(imageUrls.length);}event.target.value='';};// Create default manual slides\nconst createDefaultSlides=imageCount=>{const defaultSlides=[];for(let i=0;i<imageCount;i++){defaultSlides.push({id:Date.now()+i,text:\"Slide \".concat(i+1),startTime:i*10,// Default 10 seconds per slide\nendTime:(i+1)*10,imageIndex:i});}setSlides(defaultSlides);};// Audio event handlers\nconst handleLoadedMetadata=()=>{if(audioRef.current){setDuration(audioRef.current.duration);}};const handleTimeUpdate=()=>{if(audioRef.current){setCurrentTime(audioRef.current.currentTime);}};const handlePlayPause=async()=>{if(audioRef.current){try{if(isPlaying){audioRef.current.pause();setIsPlaying(false);}else{await audioRef.current.play();setIsPlaying(true);}}catch(error){console.error('Play error:',error);setIsPlaying(false);}}};const handleVolumeChange=e=>{const newVolume=parseFloat(e.target.value);setVolume(newVolume);if(audioRef.current){audioRef.current.volume=newVolume;}};const handleSeek=e=>{if(audioRef.current&&duration>0){const seekTime=e.target.value/100*duration;audioRef.current.currentTime=seekTime;setCurrentTime(seekTime);}};// Manual slide timing editor\nconst updateSlideTime=(slideId,field,value)=>{setSlides(slides.map(slide=>{if(slide.id===slideId){if(field==='text'){return _objectSpread(_objectSpread({},slide),{},{text:value});}else{const seconds=timeToSeconds(value);return _objectSpread(_objectSpread({},slide),{},{[field]:seconds});}}return slide;}));};// Add slide at current time\nconst addSlideAtCurrentTime=()=>{const newSlide={id:Date.now(),text:\"Slide \".concat(slides.length+1),startTime:currentTime,endTime:currentTime+10,imageIndex:Math.min(slides.length,images.length-1)};const updatedSlides=[...slides,newSlide].sort((a,b)=>a.startTime-b.startTime);setSlides(updatedSlides);setTimingMode('manual');};// Delete slide\nconst deleteSlide=slideId=>{setSlides(slides.filter(slide=>slide.id!==slideId));};// Export current timing as SRT\nconst exportToSRT=()=>{let srtContent='';slides.forEach((slide,index)=>{const startTime=formatSRTTime(slide.startTime);const endTime=formatSRTTime(slide.endTime);srtContent+=\"\".concat(index+1,\"\\n\");srtContent+=\"\".concat(startTime,\" --> \").concat(endTime,\"\\n\");srtContent+=\"\".concat(slide.text,\"\\n\\n\");});const blob=new Blob([srtContent],{type:'text/plain'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='slideshow-timing.srt';document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);};// Format time for SRT export\nconst formatSRTTime=seconds=>{const hours=Math.floor(seconds/3600);const minutes=Math.floor(seconds%3600/60);const secs=Math.floor(seconds%60);const ms=Math.floor(seconds%1*1000);return\"\".concat(hours.toString().padStart(2,'0'),\":\").concat(minutes.toString().padStart(2,'0'),\":\").concat(secs.toString().padStart(2,'0'),\",\").concat(ms.toString().padStart(3,'0'));};const formatTime=time=>{if(isNaN(time))return'0:00';const minutes=Math.floor(time/60);const seconds=Math.floor(time%60);return\"\".concat(minutes,\":\").concat(seconds.toString().padStart(2,'0'));};return/*#__PURE__*/_jsx(\"div\",{className:\"app-container \".concat(isFullscreen?'fullscreen':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"app-content\",children:[!isFullscreen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"app-title\",children:\"Advanced Slideshow with Custom Timing\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"upload-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"upload-label\",children:\"Upload Audio File\"}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"audio/*\",onChange:handleAudioUpload,className:\"hidden-input\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},className:\"upload-button audio-button\",children:[/*#__PURE__*/_jsx(Upload,{size:20}),\"Choose Audio\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"upload-label\",children:\"Upload Images\"}),/*#__PURE__*/_jsx(\"input\",{ref:imageInputRef,type:\"file\",accept:\"image/*\",multiple:true,onChange:handleImagesUpload,className:\"hidden-input\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _imageInputRef$curren;return(_imageInputRef$curren=imageInputRef.current)===null||_imageInputRef$curren===void 0?void 0:_imageInputRef$curren.click();},className:\"upload-button image-button\",children:[/*#__PURE__*/_jsx(Upload,{size:20}),\"Images (\",images.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"upload-label\",children:\"Upload SRT File (Optional)\"}),/*#__PURE__*/_jsx(\"input\",{ref:srtInputRef,type:\"file\",accept:\".srt\",onChange:handleSRTUpload,className:\"hidden-input\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _srtInputRef$current;return(_srtInputRef$current=srtInputRef.current)===null||_srtInputRef$current===void 0?void 0:_srtInputRef$current.click();},className:\"upload-button srt-button\",children:[/*#__PURE__*/_jsx(FileText,{size:20}),\"SRT Timing\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"timing-mode\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mode-indicator \".concat(timingMode==='manual'?'active':''),children:\"Manual Timing\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"mode-indicator \".concat(timingMode==='srt'?'active':''),children:[\"SRT Timing \",srtFile&&\"(\".concat(srtFile,\")\")]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"main-grid \".concat(isFullscreen?'fullscreen-grid':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"slideshow-container \".concat(isFullscreen?'fullscreen-slideshow':''),style:{cursor:controlsVisible?'default':'none'},ref:slideshowRef,onMouseMove:handleMouseMove,onMouseLeave:handleMouseLeave,children:[/*#__PURE__*/_jsx(\"div\",{className:\"slideshow-display\",children:images.length>0&&slides.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"slide-content\",children:[/*#__PURE__*/_jsx(\"img\",{src:(_images=images[((_slides$currentSlide=slides[currentSlide])===null||_slides$currentSlide===void 0?void 0:_slides$currentSlide.imageIndex)||0])===null||_images===void 0?void 0:_images.url,alt:\"Slide \".concat(currentSlide+1),className:\"slide-image \".concat(isFullscreen?'fullscreen-image':'')}),/*#__PURE__*/_jsx(\"div\",{className:\"slide-text-container\",children:/*#__PURE__*/_jsx(\"p\",{className:\"slide-text\",children:((_slides$currentSlide2=slides[currentSlide])===null||_slides$currentSlide2===void 0?void 0:_slides$currentSlide2.text)||''})}),/*#__PURE__*/_jsxs(\"div\",{className:\"slide-counter \".concat(controlsVisible?'show':'hide'),children:[currentSlide+1,\" / \",slides.length]}),/*#__PURE__*/_jsxs(\"div\",{className:\"time-counter \".concat(controlsVisible?'show':'hide'),children:[formatTime(currentTime),\" / \",formatTime(duration)]}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleFullscreen,className:\"fullscreen-button \".concat(controlsVisible?'show':'hide'),title:isFullscreen?\"Exit Fullscreen\":\"Enter Fullscreen\",children:isFullscreen?/*#__PURE__*/_jsx(Minimize2,{size:24}):/*#__PURE__*/_jsx(Maximize2,{size:24})}),isFullscreen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:goToPreviousSlide,className:\"nav-button prev-button \".concat(controlsVisible?'show':'hide'),disabled:currentSlide===0,children:/*#__PURE__*/_jsx(ChevronLeft,{size:32})}),/*#__PURE__*/_jsx(\"button\",{onClick:goToNextSlide,className:\"nav-button next-button \".concat(controlsVisible?'show':'hide'),disabled:currentSlide===slides.length-1,children:/*#__PURE__*/_jsx(ChevronRight,{size:32})})]})]},currentSlide):/*#__PURE__*/_jsx(\"div\",{className:\"empty-slideshow\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty-content\",children:[/*#__PURE__*/_jsx(Upload,{size:48,className:\"empty-icon\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Upload audio, images, and set timing\"})]})})}),audioFile&&/*#__PURE__*/_jsxs(\"div\",{className:\"audio-controls \".concat(isFullscreen?'fullscreen-audio-controls':'',\" \").concat(controlsVisible?'show':'hide'),children:[/*#__PURE__*/_jsx(\"audio\",{ref:audioRef,src:audioFile,onLoadedMetadata:handleLoadedMetadata,onTimeUpdate:handleTimeUpdate,onEnded:()=>setIsPlaying(false),className:\"hidden-audio\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"audio-controls-grid\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handlePlayPause,className:\"play-button\",children:isPlaying?/*#__PURE__*/_jsx(Pause,{size:24}):/*#__PURE__*/_jsx(Play,{size:24})}),/*#__PURE__*/_jsx(\"div\",{className:\"seek-container\",children:/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0\",max:\"100\",value:duration?currentTime/duration*100:0,onChange:handleSeek,className:\"seek-slider\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"volume-control\",children:[/*#__PURE__*/_jsx(Volume2,{size:20,className:\"volume-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"0\",max:\"1\",step:\"0.1\",value:volume,onChange:handleVolumeChange,className:\"volume-slider\"})]})]}),!isFullscreen&&/*#__PURE__*/_jsxs(\"button\",{onClick:addSlideAtCurrentTime,disabled:!audioFile,className:\"add-slide-button\",children:[/*#__PURE__*/_jsx(Plus,{size:16}),\"Add Slide at \",formatTime(currentTime)]})]})]}),!isFullscreen&&/*#__PURE__*/_jsxs(\"div\",{className:\"timing-editor\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"editor-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"editor-title\",children:\"Timing Editor\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"editor-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSlides([]),disabled:slides.length===0,className:\"clear-button\",children:\"Clear All\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:exportToSRT,disabled:slides.length===0,className:\"export-button\",children:[/*#__PURE__*/_jsx(Download,{size:14}),\"Export SRT\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"slides-timeline\",children:[slides.map((slide,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"slide-item \".concat(index===currentSlide?'active':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"slide-grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"slide-text-input\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:slide.text,onChange:e=>updateSlideTime(slide.id,'text',e.target.value),className:\"timing-input\",placeholder:\"Slide text\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"slide-time-input\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:secondsToTime(slide.startTime),onChange:e=>updateSlideTime(slide.id,'startTime',e.target.value),className:\"timing-input\",placeholder:\"Start time\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"slide-time-input\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:secondsToTime(slide.endTime),onChange:e=>updateSlideTime(slide.id,'endTime',e.target.value),className:\"timing-input\",placeholder:\"End time\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"slide-actions\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteSlide(slide.id),className:\"delete-button\",children:/*#__PURE__*/_jsx(Trash2,{size:14})})})]})},slide.id)),slides.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:\"empty-timeline\",children:[/*#__PURE__*/_jsx(Clock,{size:32,className:\"empty-icon\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No slides added yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"empty-subtext\",children:\"Upload images and add timing, or use SRT file\"})]})]})]})]}),!isFullscreen&&/*#__PURE__*/_jsxs(\"div\",{className:\"instructions-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"instructions-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"instructions-title\",children:\"Manual Timing:\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"instructions-list\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Upload audio and images\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Play audio and click \\\"Add Slide at [time]\\\" for each slide\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Edit slide text and timing in the editor\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Export to SRT if needed\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"instructions-title\",children:\"SRT File Method:\"}),/*#__PURE__*/_jsxs(\"ol\",{className:\"instructions-list\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"Create or download SRT subtitle file\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Upload audio and images\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Upload SRT file - timing will be applied automatically\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Fine-tune timing if needed\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"srt-example\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"example-title\",children:\"SRT Format Example:\"}),/*#__PURE__*/_jsx(\"pre\",{className:\"example-code\",children:\"1\\n00:00:00,500 --> 00:00:04,000\\nFirst slide text\\n\\n2\\n00:00:04,000 --> 00:00:08,500\\nSecond slide text\"})]})]})]})});};export default AdvancedSlideshow;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}